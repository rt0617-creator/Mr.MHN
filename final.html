<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr.MHN Chatbot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }
        body::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }
        #chat-container::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200">
    <div class="flex flex-col h-screen max-w-2xl mx-auto p-4">
        <header class="text-center mb-4">
            <h1 class="text-2xl sm:text-3xl font-bold text-blue-500">Mr.MHN Chatbot</h1>
        </header>

        <!-- Chat messages container -->
        <main id="chat-container" class="flex-1 overflow-y-auto p-4 bg-white dark:bg-gray-800 rounded-lg shadow-inner space-y-4">
            <!-- Initial message from the bot -->
            <div class="flex items-start gap-3">
                <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-sm">M</div>
                <div class="bg-blue-100 dark:bg-blue-900/50 text-gray-800 dark:text-gray-200 p-3 rounded-lg rounded-tl-none max-w-xs md:max-w-md">
                    <p>Hello! I'm Mr.MHN, your personal chatbot. How can I help you today?</p>
                </div>
            </div>
            <!-- More messages will be added here -->
        </main>

        <!-- Message input form -->
        <footer class="mt-4">
            <form id="chat-form" class="flex items-center gap-2">
                <input type="text" id="message-input" placeholder="Type your message..." autocomplete="off"
                    class="flex-1 p-3 bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-400 transition">
                <button type="submit" id="send-button"
                    class="w-12 h-12 bg-blue-500 text-white rounded-full flex items-center justify-center hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 dark:focus:ring-offset-gray-900 transition-transform duration-200 active:scale-90">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-send">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
            </form>
        </footer>
    </div>

    <script>
        const chatForm = document.getElementById('chat-form');
        const messageInput = document.getElementById('message-input');
        const chatContainer = document.getElementById('chat-container');
        const sendButton = document.getElementById('send-button');

        // --- ðŸ¤– START PERSONALIZATION HERE ðŸ¤– ---
        const systemPrompt = `
            You are 'Mr.MHN', a friendly, helpful, and knowledgeable chatbot.
            Your purpose is to be an engaging conversational partner.

            Here is some information you can personalize:
            - Your creator's name is rr.
            - You are chatting with [USER'S NAME HERE].
            - A key topic you know a lot about is [TOPIC OF EXPERTISE, e.g., "the history of space travel"].
            - A fun fact about yourself is [FUN FACT, e.g., "I can tell jokes in three different languages, but they are all terrible."].

            Your personality and rules:
            - Always be polite, positive, and helpful.
            - Use clear and easy-to-understand language.
            - You can use standard emojis like (ðŸ˜Š, ðŸ‘, ðŸ¤”) to add personality.
            - If you don't know something, be honest and say something like, "That's a great question! I don't have information on that right now." or "I'm not sure about that, could you tell me more?".
            - Your goal is to provide helpful and interesting conversation.
        `;
        // --- ðŸ¤– END PERSONALIZATION ðŸ¤– ---

        // --- ðŸ”‘ API KEY IS NOW ADDED ðŸ”‘ ---
        const apiKey = "AIzaSyBCN7g1ISDD8OYK4fLL4BIaREXccHTxuH4"; 
        // ------------------------------------
        
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const userMessage = messageInput.value.trim();
            if (!userMessage || apiKey === "YOUR_API_KEY_HERE") {
                if (apiKey === "YOUR_API_KEY_HERE") {
                    addMessage("It looks like the API key is missing. Please ask my creator to add it to the code.", 'bot');
                }
                return;
            }

            addMessage(userMessage, 'user');
            messageInput.value = '';
            
            await callGeminiAPI(userMessage);
        });

        function addMessage(text, sender) {
            const messageWrapper = document.createElement('div');
            const messageDiv = document.createElement('div');
            
            if (sender === 'user') {
                messageWrapper.className = 'flex justify-end';
                messageDiv.className = 'bg-blue-500 text-white p-3 rounded-lg rounded-br-none max-w-xs md:max-w-md';
            } else {
                 messageWrapper.className = 'flex items-start gap-3';
                 const botAvatar = document.createElement('div');
                 botAvatar.className = 'w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0';
                 botAvatar.textContent = 'M';
                 messageWrapper.appendChild(botAvatar);
                 messageDiv.className = 'bg-blue-100 dark:bg-blue-900/50 text-gray-800 dark:text-gray-200 p-3 rounded-lg rounded-tl-none max-w-xs md:max-w-md';
                 if (text === '...') {
                    messageDiv.id = 'loading-indicator';
                 }
            }

            messageDiv.innerHTML = `<p>${text.replace(/\n/g, '<br>')}</p>`;
            messageWrapper.appendChild(messageDiv);
            chatContainer.appendChild(messageWrapper);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        async function callGeminiAPI(userMessage) {
            addMessage('...', 'bot'); // Show loading indicator
            sendButton.disabled = true;

            const payload = {
                contents: [{ parts: [{ text: userMessage }] }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.statusText}`);
                }

                const result = await response.json();
                const loadingIndicator = document.getElementById('loading-indicator');
                if (loadingIndicator) {
                    chatContainer.removeChild(loadingIndicator.parentElement);
                }

                const botResponse = result.candidates?.[0]?.content?.parts?.[0]?.text || "I'm not sure what to say, but I think you're great! ðŸ˜Š";
                addMessage(botResponse, 'bot');

            } catch (error) {
                console.error("Error calling Gemini API:", error);
                 const loadingIndicator = document.getElementById('loading-indicator');
                if (loadingIndicator) {
                    chatContainer.removeChild(loadingIndicator.parentElement);
                }
                addMessage("Oops! My circuits are a little frazzled. Maybe try again in a moment?", 'bot');
            } finally {
                sendButton.disabled = false;
                messageInput.focus();
            }
        }
    </script>
</body>
</html>

